{"version":3,"file":"web-BAzmhnwW.js","sources":["../../node_modules/@capacitor-community/camera-preview/dist/esm/web.js"],"sourcesContent":["import { WebPlugin } from '@capacitor/core';\nexport class CameraPreviewWeb extends WebPlugin {\n    constructor() {\n        super({\n            name: 'CameraPreview',\n            platforms: ['web'],\n        });\n    }\n    async start(options) {\n        return new Promise(async (resolve, reject) => {\n            var _a;\n            await navigator.mediaDevices\n                .getUserMedia({\n                audio: !options.disableAudio,\n                video: true,\n            })\n                .then((stream) => {\n                // Stop any existing stream so we can request media with different constraints based on user input\n                stream.getTracks().forEach((track) => track.stop());\n            })\n                .catch((error) => {\n                reject(error);\n            });\n            const video = document.getElementById('video');\n            const parent = document.getElementById(options.parent);\n            if (!video) {\n                const videoElement = document.createElement('video');\n                videoElement.id = 'video';\n                videoElement.setAttribute('class', options.className || '');\n                // Don't flip video feed if camera is rear facing\n                if (options.position !== 'rear') {\n                    videoElement.setAttribute('style', '-webkit-transform: scaleX(-1); transform: scaleX(-1);');\n                }\n                const userAgent = navigator.userAgent.toLowerCase();\n                const isSafari = userAgent.includes('safari') && !userAgent.includes('chrome');\n                // Safari on iOS needs to have the autoplay, muted and playsinline attributes set for video.play() to be successful\n                // Without these attributes videoElement.play() will throw a NotAllowedError\n                // https://developer.apple.com/documentation/webkit/delivering_video_content_for_safari\n                if (isSafari) {\n                    videoElement.setAttribute('autoplay', 'true');\n                    videoElement.setAttribute('muted', 'true');\n                    videoElement.setAttribute('playsinline', 'true');\n                }\n                parent.appendChild(videoElement);\n                if ((_a = navigator.mediaDevices) === null || _a === void 0 ? void 0 : _a.getUserMedia) {\n                    const constraints = {\n                        video: {\n                            width: { ideal: options.width },\n                            height: { ideal: options.height },\n                        },\n                    };\n                    if (options.position === 'rear') {\n                        constraints.video.facingMode = 'environment';\n                        this.isBackCamera = true;\n                    }\n                    else {\n                        this.isBackCamera = false;\n                    }\n                    navigator.mediaDevices.getUserMedia(constraints).then(function (stream) {\n                        //video.src = window.URL.createObjectURL(stream);\n                        videoElement.srcObject = stream;\n                        videoElement.play();\n                        resolve();\n                    }, (err) => {\n                        reject(err);\n                    });\n                }\n            }\n            else {\n                reject({ message: 'camera already started' });\n            }\n        });\n    }\n    // async startRecordVideo(): Promise<void> {\n    //   throw this.unimplemented('Not implemented on web.');\n    // }\n    // async stopRecordVideo(): Promise<void> {\n    //   throw this.unimplemented('Not implemented on web.');\n    // }\n    async stop() {\n        const video = document.getElementById('video');\n        if (video) {\n            video.pause();\n            const st = video.srcObject;\n            const tracks = st.getTracks();\n            for (let i = 0; i < tracks.length; i++) {\n                const track = tracks[i];\n                track.stop();\n            }\n            video.remove();\n        }\n    }\n    async capture(options) {\n        return new Promise((resolve, _) => {\n            const video = document.getElementById('video');\n            const canvas = document.createElement('canvas');\n            // video.width = video.offsetWidth;\n            const context = canvas.getContext('2d');\n            canvas.width = video.videoWidth;\n            canvas.height = video.videoHeight;\n            // flip horizontally back camera isn't used\n            if (!this.isBackCamera) {\n                context.translate(video.videoWidth, 0);\n                context.scale(-1, 1);\n            }\n            context.drawImage(video, 0, 0, video.videoWidth, video.videoHeight);\n            let base64EncodedImage;\n            if (options.quality != undefined) {\n                base64EncodedImage = canvas\n                    .toDataURL('image/jpeg', options.quality / 100.0)\n                    .replace('data:image/jpeg;base64,', '');\n            }\n            else {\n                base64EncodedImage = canvas.toDataURL('image/png').replace('data:image/png;base64,', '');\n            }\n            resolve({\n                value: base64EncodedImage,\n            });\n        });\n    }\n    // async captureSample(_options: CameraSampleOptions): Promise<any> {\n    //   return this.capture(_options);\n    // }\n    async getSupportedFlashModes() {\n        throw new Error('getSupportedFlashModes not supported under the web platform');\n    }\n    async setFlashMode(_options) {\n        throw new Error('setFlashMode not supported under the web platform');\n    }\n    async flip() {\n        throw new Error('flip not supported under the web platform');\n    }\n    async openAppSettings() {\n        throw this.unimplemented('openAppSettings no est√° disponible en la plataforma web.');\n    }\n}\n//# sourceMappingURL=web.js.map"],"names":["CameraPreviewWeb","WebPlugin","options","resolve","reject","_a","stream","track","error","video","parent","videoElement","userAgent","constraints","err","tracks","i","_","canvas","context","base64EncodedImage","_options"],"mappings":"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","x_google_ignoreList":[0]}